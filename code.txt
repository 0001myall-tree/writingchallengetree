<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê¸€ì“°ê¸° í›ˆë ¨ ì±Œë¦°ì§€ â€” ë‹¨ê±°ë¦¬/ë§ˆë¼í†¤/ì•„ì´ë””ì–´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@500&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
  <style>
  :root{
    --bg:#f6f5f3;
    --card:#ffffffcc;
    --ink:#2b2b2b;
    --muted:#7b7b7b;
    --brand:#6b4de6;
    --brand2:#a077ff;
    --ring:rgba(17, 16, 30, .06);
    --ok:#1a7f37;
    --danger:#e23e57;
    --grad:linear-gradient(135deg, #6b4de6, #a077ff);
    --grad-soft:linear-gradient(180deg, rgba(255,255,255,.6), rgba(255,255,255,.3));
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    font-family:'Noto Sans KR', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background:
      radial-gradient(1200px 600px at 10% -10%, #efe9ff 0%, transparent 60%),
      radial-gradient(1000px 500px at 100% 0%, #ffe9f0 0%, transparent 55%),
      var(--bg);
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }

  /* Header */
  header{
    position:relative;
    text-align:center; padding:56px 16px 46px; color:#fff;
    background:var(--grad);
    overflow:hidden;
  }
  header::after{
    content:""; position:absolute; inset:auto -20% -80% -20%; height:180%;
    background:radial-gradient(60% 60% at 50% 40%, rgba(255,255,255,.25), transparent 60%);
    filter:blur(40px);
  }
  header h1{
    margin:0 0 8px; font-family:'Noto Serif KR', serif;
    font-size:30px; letter-spacing:.2px
  }
  header p{margin:0; opacity:.9}

  /* Top bar (nav + lang) */
  .topbar{
    position:sticky; top:0; z-index:10;
    background:rgba(255,255,255,.6); backdrop-filter:blur(10px);
    border-bottom:1px solid rgba(0,0,0,.06);
  }
  .topbar-inner{
    max-width:960px; margin:0 auto; padding:10px 16px;
    display:flex; gap:8px; align-items:center; justify-content:space-between;
  }
  .tabs{display:flex; gap:6px; flex-wrap:wrap}
  .tab{
    background:#fff; color:#3f35a4; border:1px solid #e8e3ff;
    border-radius:999px; padding:8px 14px; font-weight:700; cursor:pointer;
    box-shadow:0 6px 12px rgba(63,53,164,.06); transition:filter .15s, transform .15s;
  }
  .tab:hover{filter:brightness(1.02); transform:translateY(-1px)}
  .tab.active{background:linear-gradient(135deg,#f5f2ff,#fff); border-color:#cfc6ff}
  .langbtn{
    background:#181818; color:#fff; border:none; border-radius:999px;
    padding:8px 12px; font-weight:800; letter-spacing:.2px; cursor:pointer;
  }

  .wrap{max-width:920px; margin:-28px auto 28px; padding:0 16px}
  .card{
    backdrop-filter:saturate(160%) blur(6px);
    background:var(--card);
    border:1px solid rgba(255,255,255,.65);
    border-radius:16px;
    box-shadow:0 20px 40px var(--ring);
    padding:24px; margin-bottom:20px;
  }
  .row{display:flex; flex-wrap:wrap; gap:12px; align-items:center}
  .stack{display:flex; flex-direction:column; gap:16px}

  h2,h3{
    font-family:'Noto Serif KR', serif; margin:0 0 14px;
    color:#3f35a4; letter-spacing:.2px
  }
  label{font-weight:700; font-size:14px; color:#504e62}

  select,input[type="number"]{
    padding:12px 14px; border:1px solid #e6e2f4; border-radius:12px; font-size:15px;
    background:#fff; min-width:140px; transition:border-color .15s, box-shadow .15s;
  }
  select:focus, input[type="number"]:focus{
    outline:none; border-color:#c7b9ff; box-shadow:0 0 0 5px rgba(163,140,255,.18)
  }

  button{
    background:var(--grad); color:#fff; border:none;
    border-radius:28px; padding:12px 20px; font-weight:800; letter-spacing:.2px;
    cursor:pointer; transition:.18s transform,.18s box-shadow, filter .18s;
    box-shadow:0 10px 18px rgba(107,77,230,.18);
  }
  button:hover{transform:translateY(-1px); box-shadow:0 16px 28px rgba(107,77,230,.22)}
  button:active{transform:translateY(0)}
  button.ghost{
    background:#ffffff; color:#3b3b3b; border:1px solid #e9e6f7;
    box-shadow:0 6px 14px rgba(0,0,0,.04)
  }
  button.danger{background:linear-gradient(135deg, #e23e57, #ff6a7b); box-shadow:0 10px 18px rgba(226,62,87,.18)}

  .muted{color:var(--muted)}
  .center{text-align:center}
  .success{color:var(--ok); font-weight:800}
  .fail{color:var(--danger); font-weight:800}
  .hr{height:1px; background:linear-gradient(90deg, #eee 0%, #f6f5ff 50%, #eee 100%); margin:18px 0}

  .stats{display:flex; gap:16px; flex-wrap:wrap; justify-content:center; margin-top:8px}
  .stat{
    background:var(--grad-soft); border:1px solid rgba(255,255,255,.7);
    border-radius:12px; padding:12px 14px; min-width:160px; text-align:center;
    box-shadow:0 8px 18px var(--ring)
  }
  .timer{font-size:24px; font-weight:900; color:#e23e57; letter-spacing:.5px}

  textarea{
    width:100%; min-height:360px; padding:18px 16px; font-size:16.5px; line-height:1.7;
    border:1px solid #ece8ff; border-radius:14px; resize:vertical; background:#fff;
    transition:border-color .15s, box-shadow .15s;
  }
  textarea:focus{border-color:#c7b9ff; box-shadow:0 0 0 6px rgba(163,140,255,.16)}

  .progress-wrap{width:100%; background:#f3f0ff; border-radius:12px; overflow:hidden; height:14px; border:1px solid #e8e3ff}
  .progress-bar{height:100%; width:0%; background:linear-gradient(90deg, #6b4de6, #a077ff); transition:width .2s ease}
  .progress-line{display:flex; justify-content:space-between; font-size:13px; color:#5d5778; margin-bottom:8px}

  .difficulty-block{display:flex; align-items:center; gap:12px; padding:12px 0}
  .difficulty-block + .difficulty-block{border-top:1px dashed #e6e2f4; margin-top:8px; padding-top:18px}

  .share-buttons{display:flex; justify-content:center; gap:12px; margin-top:18px; flex-wrap:wrap}
  .share-buttons button{
    padding:10px 16px; border-radius:22px; font-size:14px;
    background:#fff; color:#3f35a4; border:1px solid #e8e3ff;
    box-shadow:0 6px 12px rgba(63,53,164,.06)
  }
  .share-buttons button:hover{filter:brightness(1.02)}

  .list{display:grid; gap:10px}
  .list .item{
    border:1px solid #eee; border-radius:12px; padding:14px; background:#fff;
  }
  .list .item h4{margin:0 0 6px; font-size:16px; color:#2d267a}
  .list .item p{margin:0; font-size:14px; color:#4d4a60}

  footer{
    margin:40px auto 48px; max-width:920px; padding:0 16px;
    color:#5c5a6d; font-size:13px;
  }
  footer a{color:#4c40c6; text-decoration:none}
  footer .links{display:flex; gap:12px; flex-wrap:wrap}

  @media (max-width:640px){
    header h1{font-size:24px}
    .stat{min-width:140px}
    textarea{min-height:320px}
  }

  @media (prefers-color-scheme: dark){
    :root{
      --bg:#12121a; --ink:#e9e9ef; --muted:#a6a6b3;
      --card:rgba(22,22,32,.6); --ring:rgba(0,0,0,.5);
    }
    .card{border:1px solid rgba(255,255,255,.12)}
    select, input[type="number"], textarea{background:#171726; color:var(--ink); border-color:#2a2740}
    textarea:focus{box-shadow:0 0 0 6px rgba(107,77,230,.25)}
    .progress-wrap{background:#1c1b2a; border-color:#2a2740}
    .share-buttons button{background:#181828; color:#cfcaff; border-color:#2a2740}
    .difficulty-block + .difficulty-block{border-top-color:#2a2740}
    .list .item{background:#171726; border-color:#2a2740}
    .list .item p{color:#bbb9d4}
  }

  /* Utilities */
  .hidden{display:none !important;}
  </style>
</head>
<body>
  <header>
    <h1 data-i18n="title">ê¸€ì“°ê¸° í›ˆë ¨ ì±Œë¦°ì§€</h1>
    <p data-i18n="subtitle">ë‹¨ê±°ë¦¬ / ë§ˆë¼í†¤ / ì•„ì´ë””ì–´ Â· Hard/Soft ëª¨ë“œ Â· ê²°ê³¼ ê³µìœ </p>
  </header>

  <!-- Top nav & language -->
  <div class="topbar">
    <div class="topbar-inner">
      <div class="tabs">
        <button class="tab active" data-route="tool" data-i18n="tab_tool">Tool</button>
        <button class="tab" data-route="howto" data-i18n="tab_howto">How to Use</button>
        <button class="tab" data-route="guides" data-i18n="tab_guides">Writing Guides</button>
      </div>
      <button id="langToggle" class="langbtn" aria-label="Toggle language">KR / EN</button>
    </div>
  </div>

  <div class="wrap">

    <!-- ============ SECTION: TOOL (App) ============ -->
    <section id="section-tool">

      <!-- ëª¨ë“œ ì„ íƒ -->
      <div class="card" id="modeCard">
        <h2 data-i18n="mode_title">ëª¨ë“œ ì„ íƒ</h2>
        <div class="stack">
          <div class="row">
            <button id="btnSprint" data-i18n="mode_sprint_btn">ë‹¨ê±°ë¦¬ ëª¨ë“œ</button>
            <span class="muted" data-i18n="mode_sprint_desc">Â· 3/5/10/20/30ë¶„ Â· <b>5ì´ˆ</b> ë©ˆì¶”ë©´ ì‹¤íŒ¨</span>
          </div>
          <div class="row">
            <button id="btnMarathon" data-i18n="mode_marathon_btn">ë§ˆë¼í†¤ ëª¨ë“œ</button>
            <span class="muted" data-i18n="mode_marathon_desc">Â· ëª©í‘œ ê¸€ììˆ˜ + 40/60/90/120ë¶„ Â· ë¯¸ë‹¬ ì‹œ ì‹¤íŒ¨</span>
          </div>
          <div class="row">
            <button id="btnIdea" data-i18n="mode_idea_btn">ì•„ì´ë””ì–´ ëª¨ë“œ</button>
            <span class="muted" data-i18n="mode_idea_desc">Â· 10/20/30ë¶„ Â· <b>1ë¶„</b> ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨</span>
          </div>
        </div>
      </div>

      <!-- ë‚œì´ë„ ì„ íƒ -->
      <div class="card hidden" id="difficultyCard">
        <h3 data-i18n="difficulty_title">ë‚œì´ë„ ì„ íƒ</h3>
        <div class="difficulty-block">
          <button id="btnHard">ğŸ”¥ <span data-i18n="difficulty_hard">Hard</span></button>
          <span class="muted" data-i18n="difficulty_hard_desc">ì‹¤íŒ¨ ì‹œ ì›ê³  ì‚­ì œ</span>
        </div>
        <div class="difficulty-block">
          <button id="btnSoft">ğŸŒ± <span data-i18n="difficulty_soft">Soft</span></button>
          <span class="muted" data-i18n="difficulty_soft_desc">ì‹¤íŒ¨í•´ë„ ì›ê³  ë³´ì¡´ (ë©”ì‹œì§€ë§Œ í‘œì‹œ)</span>
        </div>
      </div>

      <!-- ë‹¨ê±°ë¦¬ ì„¤ì • -->
      <div class="card hidden" id="sprintSetup">
        <h3 data-i18n="sprint_title">ë‹¨ê±°ë¦¬ ì„¤ì •</h3>
        <div class="row">
          <label for="sprintDuration" data-i18n="label_session_time">ì„¸ì…˜ ì‹œê°„</label>
          <select id="sprintDuration">
            <option value="180" data-i18n="min_3">3ë¶„</option>
            <option value="300" selected data-i18n="min_5">5ë¶„</option>
            <option value="600" data-i18n="min_10">10ë¶„</option>
            <option value="1200" data-i18n="min_20">20ë¶„</option>
            <option value="1800" data-i18n="min_30">30ë¶„</option>
          </select>
          <button id="startSprint" data-i18n="btn_start">ì‹œì‘</button>
          <button class="ghost" id="backFromSprint" data-i18n="btn_back">ë’¤ë¡œ</button>
        </div>
        <div class="hr"></div>
        <p class="muted" data-i18n="sprint_rule">íƒ€ì´í•‘ì´ <b>5ì´ˆ ì´ìƒ</b> ë©ˆì¶”ë©´ ì¦‰ì‹œ ì‹¤íŒ¨.</p>
      </div>

      <!-- ë§ˆë¼í†¤ ì„¤ì • -->
      <div class="card hidden" id="marathonSetup">
        <h3 data-i18n="marathon_title">ë§ˆë¼í†¤ ì„¤ì •</h3>
        <div class="row">
          <label for="targetChars" data-i18n="label_target_chars">ëª©í‘œ ê¸€ììˆ˜</label>
          <input type="number" id="targetChars" min="500" step="100" value="4000" />
          <label for="marathonDuration" style="margin-left:10px" data-i18n="label_session_time">ì„¸ì…˜ ì‹œê°„</label>
          <select id="marathonDuration">
            <option value="2400" selected data-i18n="min_40">40ë¶„</option>
            <option value="3600" data-i18n="hr_1">1ì‹œê°„</option>
            <option value="5400" data-i18n="hr_1_5">1ì‹œê°„ 30ë¶„</option>
            <option value="7200" data-i18n="hr_2">2ì‹œê°„</option>
          </select>
          <button id="startMarathon" data-i18n="btn_start">ì‹œì‘</button>
          <button class="ghost" id="backFromMarathon" data-i18n="btn_back">ë’¤ë¡œ</button>
        </div>
        <div class="hr"></div>
        <p class="muted" data-i18n="marathon_rule"><b>ì‹œê°„ ë‚´ ëª©í‘œ ê¸€ììˆ˜ ë¯¸ë‹¬</b> ì‹œ ì‹¤íŒ¨ ì²˜ë¦¬.</p>
      </div>

      <!-- ì•„ì´ë””ì–´ ì„¤ì • -->
      <div class="card hidden" id="ideaSetup">
        <h3 data-i18n="idea_title">ì•„ì´ë””ì–´ ëª¨ë“œ ì„¤ì •</h3>
        <div class="row">
          <label for="ideaDuration" data-i18n="label_session_time">ì„¸ì…˜ ì‹œê°„</label>
          <select id="ideaDuration" aria-label="ì•„ì´ë””ì–´ ì‹œê°„">
            <option value="600" selected data-i18n="min_10">10ë¶„</option>
            <option value="1200" data-i18n="min_20">20ë¶„</option>
            <option value="1800" data-i18n="min_30">30ë¶„</option>
          </select>
          <button id="startIdea" data-i18n="btn_start">ì‹œì‘</button>
          <button class="ghost" id="backFromIdea" data-i18n="btn_back">ë’¤ë¡œ</button>
        </div>
        <div class="hr"></div>
        <p class="muted" data-i18n="idea_rule">ê·œì¹™: <b>1ë¶„ ì´ìƒ</b> í‚¤ ì…ë ¥ì´ ì—†ìœ¼ë©´ ì¦‰ì‹œ ì‹¤íŒ¨. (ê¸€ììˆ˜ ëª©í‘œ ì—†ìŒ)</p>
      </div>

      <!-- ê¸€ì“°ê¸° í™”ë©´ -->
      <div class="card hidden" id="writingCard">
        <h3 id="sessionTitle" data-i18n="session_running">ì„¸ì…˜ ì§„í–‰ì¤‘</h3>
        <div class="stats">
          <div class="stat"><div class="muted" data-i18n="label_time_left">ë‚¨ì€ ì‹œê°„</div><div class="timer" id="timeLeft">--:--</div></div>
          <div class="stat"><div class="muted" data-i18n="label_char_count">í˜„ì¬ ê¸€ììˆ˜</div><div id="charCount">0</div></div>
          <div class="stat hidden" id="goalBox"><div class="muted" data-i18n="label_goal_chars">ëª©í‘œ ê¸€ììˆ˜</div><div id="goalChars">0</div></div>
        </div>

        <div id="progressWrap" class="hidden">
          <div class="progress-line">
            <span id="progressLabel">ì§„í–‰: 0 / 0 (0%)</span>
            <span class="muted" id="paceHint"></span>
          </div>
          <div class="progress-wrap" aria-label="ì§„í–‰ë¥ ">
            <div class="progress-bar" id="progressBar"></div>
          </div>
        </div>

        <div class="hr"></div>
        <textarea id="editor" placeholder="ì—¬ê¸°ì— ì›ê³ /ì•„ì´ë””ì–´ë¥¼ ì‘ì„±í•˜ì„¸ìš”..." data-i18n-placeholder="placeholder_editor"></textarea>
        <p id="statusLine" class="center muted" data-i18n="status_waiting">ì…ë ¥ ëŒ€ê¸° ì¤‘â€¦</p>
        <div class="center">
          <button class="danger" id="giveUp" data-i18n="btn_giveup">í¬ê¸°(ì¦‰ì‹œ ì¢…ë£Œ)</button>
        </div>
      </div>

      <!-- ê²°ê³¼ í™”ë©´ -->
      <div class="card hidden" id="resultCard">
        <h3 id="resultHeadline">ê²°ê³¼</h3>
        <p id="resultDetail" class="center"></p>
        <div class="center" style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap; margin-top:8px">
          <button id="restart" data-i18n="btn_restart">ë‹¤ì‹œ ì‹œì‘</button>
        </div>
        <div class="share-buttons">
          <button id="shareKakao">ì¹´ì¹´ì˜¤í†¡</button>
          <button id="shareTwitter">X(íŠ¸ìœ„í„°)</button>
          <button id="shareCopy">ğŸ“‹ ë³µì‚¬</button>
        </div>
      </div>

    </section>

    <!-- ============ SECTION: HOW TO USE (Content for AdSense) ============ -->
    <section id="section-howto" class="hidden">
      <div class="card">
        <h2 data-i18n="howto_h2">ì´ ë„êµ¬ í™œìš©ë²•</h2>
        <p class="muted" data-i18n="howto_intro">
          ì´ í˜ì´ì§€ëŠ” ê¸€ì“°ê¸° ì†ë„ë¥¼ ë†’ì´ê³  ê¾¸ì¤€í•¨ì„ ë§Œë“œëŠ” ì‘ì€ í›ˆë ¨ì¥ì…ë‹ˆë‹¤. ì•„ë˜ ê°€ì´ë“œë¥¼ ì°¸ê³ í•´ ìì‹ ì—ê²Œ ë§ëŠ” ê·œì¹™ì„ ì„¸ì›Œë³´ì„¸ìš”.
        </p>
        <div class="hr"></div>
        <div class="list">
          <div class="item">
            <h4 data-i18n="howto_1_title">1) ëª©í‘œ ì •í•˜ê¸°</h4>
            <p data-i18n="howto_1_body">
              ë‹¨ê±°ë¦¬(Sprint)ëŠ” â€˜ì¤‘ë‹¨ ê¸ˆì§€â€™ì— ì§‘ì¤‘, ë§ˆë¼í†¤(Marathon)ì€ â€˜ì´ ê¸€ììˆ˜â€™ë¥¼ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ì•„ì´ë””ì–´ ëª¨ë“œëŠ” ììœ ë¡­ê²Œ ë¸Œë ˆì¸ìŠ¤í† ë°í•˜ì„¸ìš”.
            </p>
          </div>
          <div class="item">
            <h4 data-i18n="howto_2_title">2) í™˜ê²½ ì„¸íŒ…</h4>
            <p data-i18n="howto_2_body">
              ë°©í•´ ìš”ì†Œ(íœ´ëŒ€í° ì•Œë¦¼, ë©”ì‹ ì €)ë¥¼ ë„ê³ , íƒ€ì´ë¨¸ ì‹œê°„ì„ ì •í•©ë‹ˆë‹¤. ì´ˆë°˜ì—” 5~10ë¶„, ì´í›„ 20~30ë¶„ìœ¼ë¡œ ëŠ˜ë ¤ë³´ì„¸ìš”.
            </p>
          </div>
          <div class="item">
            <h4 data-i18n="howto_3_title">3) ê·œì¹™ ì ìš©</h4>
            <p data-i18n="howto_3_body">
              SprintëŠ” 5ì´ˆ ì´ìƒ ë©ˆì¶”ë©´ ì‹¤íŒ¨, Marathonì€ ì‹œê°„ ë‚´ ëª©í‘œ ê¸€ììˆ˜ ë¯¸ë‹¬ ì‹œ ì‹¤íŒ¨, IdeaëŠ” 1ë¶„ ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨ì…ë‹ˆë‹¤.
            </p>
          </div>
          <div class="item">
            <h4 data-i18n="howto_4_title">4) ê¸°ë¡ & íšŒê³ </h4>
            <p data-i18n="howto_4_body">
              ì„±ê³µ/ì‹¤íŒ¨ ì´ìœ ë¥¼ ê°„ë‹¨íˆ ì ì–´ ë‘ë©´ ë‹¤ìŒ ì„¸ì…˜ì˜ í’ˆì§ˆì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤. ìì‹ ì˜ ìµœì  ì‹œê°„ëŒ€ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.
            </p>
          </div>
        </div>
      </div>

 
    </section>

    <!-- ============ SECTION: WRITING GUIDES (Book recs) ============ -->
    <section id="section-guides" class="hidden">
      <div class="card">
        <h2 data-i18n="guides_h2">ê¸€ì“°ê¸° ê°€ì´ë“œ & ì¶”ì²œ ì‘ë²•ì„œ</h2>
        <p class="muted" data-i18n="guides_intro">
          ì•„ë˜ ëª©ë¡ì€ ìŠ¤í† ë¦¬ êµ¬ì¡°ë¥¼ ë¹ ë¥´ê²Œ ì¡ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ëŒ€í‘œ ì°¸ê³ ì„œë“¤ì…ë‹ˆë‹¤.
        </p>
        <div class="hr"></div>
        <div class="list">
          <div class="item">
            <h4><em>Save the Cat! ë‚˜ì˜ ì²« ì†Œì„¤ ì“°ê¸°</em> â€” ì œì‹œì¹´ ë¸Œë¡œë””</h4>
            <p data-i18n="btc_stc_novel">
              ì•„ì´ë””ì–´ë¥¼ ì†Œì„¤ë¡œ ë¹šì–´ë‚´ê¸° ìœ„í•œ 15ê°€ì§€ ì›ì¹™ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
          </div>
          <div class="item">
            <h4><em>Save the Cat!</em> â€” ë¸”ë ˆì´í¬ ìŠ¤ë‹ˆë”</h4>
            <p data-i18n="btc_stc_screen">
              ì‹œë‚˜ë¦¬ì˜¤ ì›ì „. ì‹œë‚˜ë¦¬ì˜¤ ë¶ˆë³€ì˜ ë²•ì¹™ë“¤ì„ ì ê²€í•˜ì„¸ìš”.
            </p>
          </div>
          <div class="item">
            <h4><em>ìŠ¤í† ë¦¬: ì‹œë‚˜ë¦¬ì˜¤ ì–´ë–»ê²Œ ì“¸ ê²ƒì¸ê°€</em> â€” ë¡œë²„íŠ¸ ë§¥í‚¤</h4>
            <p data-i18n="btc_mckee">
              í• ë¦¬ìš°ë“œê°€ ì¸ì •í•œ ì‹œë‚˜ë¦¬ì˜¤ ì‘ë²•ì˜ ëŒ€ê°€ì¸ ë¡œë²„íŠ¸ ë§¥í‚¤ê°€ ì“´ ì±…ìœ¼ë¡œ í˜„ì¬ê¹Œì§€ ì‹œë‚˜ë¦¬ì˜¤ ì‘ë²•ì˜ ì •ì„ìœ¼ë¡œ ì¸ì •ë°›ëŠ” ì±…ì´ë‹¤.
            </p>
          </div>
          <div class="item">
          </div>
        </div>
      </div>

  <footer>
    <div class="links">
      <a href="#" id="open-privacy" data-i18n="footer_privacy">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a>
      <a href="#" id="open-terms" data-i18n="footer_terms">ì´ìš©ì•½ê´€</a>
      <a href="#" id="open-contact" data-i18n="footer_contact">ë¬¸ì˜</a>
    </div>
    <p class="muted" style="margin-top:8px" data-i18n="footer_note">
      ë³¸ ì‚¬ì´íŠ¸ëŠ” êµìœ¡/ì°½ì‘ í›ˆë ¨ì„ ìœ„í•œ ì •ì  ì›¹ ì•±ì…ë‹ˆë‹¤. í°íŠ¸ëŠ” Google Fonts(OFL) ì‚¬ìš©.
    </p>
  </footer>

  <!-- ======================= SCRIPT ======================= -->
  <script>
  // ---------- Simple Router (tabs) ----------
  const sections = {
    tool: document.getElementById('section-tool'),
    howto: document.getElementById('section-howto'),
    guides: document.getElementById('section-guides'),
  };
  const tabs = Array.from(document.querySelectorAll('.tab'));
  function go(route){
    Object.values(sections).forEach(s=>s.classList.add('hidden'));
    sections[route]?.classList.remove('hidden');
    tabs.forEach(t=>t.classList.toggle('active', t.dataset.route===route));
    // keep hash for share
    location.hash = route;
  }
  tabs.forEach(t=> t.addEventListener('click', ()=>go(t.dataset.route)));
  window.addEventListener('load', ()=>{
    const hash = location.hash.replace('#','');
    go( (hash && sections[hash]) ? hash : 'tool' );
  });

  // ---------- i18n (KR/EN toggle) ----------
  const dict = {
    ko: {
      title:'ê¸€ì“°ê¸° í›ˆë ¨ ì±Œë¦°ì§€',
      subtitle:'ë‹¨ê±°ë¦¬ / ë§ˆë¼í†¤ / ì•„ì´ë””ì–´ Â· Hard/Soft ëª¨ë“œ Â· ê²°ê³¼ ê³µìœ ',
      tab_tool:'Tool', tab_howto:'How to Use', tab_guides:'Writing Guides',
      mode_title:'ëª¨ë“œ ì„ íƒ',
      mode_sprint_btn:'ë‹¨ê±°ë¦¬ ëª¨ë“œ',
      mode_sprint_desc:'Â· 3/5/10/20/30ë¶„ Â· <b>5ì´ˆ</b> ë©ˆì¶”ë©´ ì‹¤íŒ¨',
      mode_marathon_btn:'ë§ˆë¼í†¤ ëª¨ë“œ',
      mode_marathon_desc:'Â· ëª©í‘œ ê¸€ììˆ˜ + 40/60/90/120ë¶„ Â· ë¯¸ë‹¬ ì‹œ ì‹¤íŒ¨',
      mode_idea_btn:'ì•„ì´ë””ì–´ ëª¨ë“œ',
      mode_idea_desc:'Â· 10/20/30ë¶„ Â· <b>1ë¶„</b> ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨',
      difficulty_title:'ë‚œì´ë„ ì„ íƒ',
      difficulty_hard:'Hard', difficulty_hard_desc:'ì‹¤íŒ¨ ì‹œ ì›ê³  ì‚­ì œ',
      difficulty_soft:'Soft', difficulty_soft_desc:'ì‹¤íŒ¨í•´ë„ ì›ê³  ë³´ì¡´ (ë©”ì‹œì§€ë§Œ í‘œì‹œ)',
      sprint_title:'ë‹¨ê±°ë¦¬ ì„¤ì •',
      label_session_time:'ì„¸ì…˜ ì‹œê°„',
      min_3:'3ë¶„', min_5:'5ë¶„', min_10:'10ë¶„', min_20:'20ë¶„', min_30:'30ë¶„',
      min_40:'40ë¶„', hr_1:'1ì‹œê°„', hr_1_5:'1ì‹œê°„ 30ë¶„', hr_2:'2ì‹œê°„',
      btn_start:'ì‹œì‘', btn_back:'ë’¤ë¡œ',
      sprint_rule:'íƒ€ì´í•‘ì´ <b>5ì´ˆ ì´ìƒ</b> ë©ˆì¶”ë©´ ì¦‰ì‹œ ì‹¤íŒ¨.',
      marathon_title:'ë§ˆë¼í†¤ ì„¤ì •',
      label_target_chars:'ëª©í‘œ ê¸€ììˆ˜',
      marathon_rule:'<b>ì‹œê°„ ë‚´ ëª©í‘œ ê¸€ììˆ˜ ë¯¸ë‹¬</b> ì‹œ ì‹¤íŒ¨ ì²˜ë¦¬.',
      idea_title:'ì•„ì´ë””ì–´ ëª¨ë“œ ì„¤ì •',
      idea_rule:'ê·œì¹™: <b>1ë¶„ ì´ìƒ</b> í‚¤ ì…ë ¥ì´ ì—†ìœ¼ë©´ ì¦‰ì‹œ ì‹¤íŒ¨. (ê¸€ììˆ˜ ëª©í‘œ ì—†ìŒ)',
      session_running:'ì„¸ì…˜ ì§„í–‰ì¤‘',
      label_time_left:'ë‚¨ì€ ì‹œê°„',
      label_char_count:'í˜„ì¬ ê¸€ììˆ˜',
      label_goal_chars:'ëª©í‘œ ê¸€ììˆ˜',
      placeholder_editor:'ì—¬ê¸°ì— ì›ê³ /ì•„ì´ë””ì–´ë¥¼ ì‘ì„±í•˜ì„¸ìš”...',
      status_waiting:'ì…ë ¥ ëŒ€ê¸° ì¤‘â€¦',
      btn_giveup:'í¬ê¸°(ì¦‰ì‹œ ì¢…ë£Œ)',
      btn_restart:'ë‹¤ì‹œ ì‹œì‘',

      howto_h2:'ì´ ë„êµ¬ í™œìš©ë²•',
      howto_intro:'ì´ í˜ì´ì§€ëŠ” ê¸€ì“°ê¸° ì†ë„ë¥¼ ë†’ì´ê³  ê¾¸ì¤€í•¨ì„ ë§Œë“œëŠ” ì‘ì€ í›ˆë ¨ì¥ì…ë‹ˆë‹¤. ì•„ë˜ ê°€ì´ë“œë¥¼ ì°¸ê³ í•´ ìì‹ ì—ê²Œ ë§ëŠ” ê·œì¹™ì„ ì„¸ì›Œë³´ì„¸ìš”.',
      howto_1_title:'1) ëª©í‘œ ì •í•˜ê¸°',
      howto_1_body:'ë‹¨ê±°ë¦¬(Sprint)ëŠ” â€˜ì¤‘ë‹¨ ê¸ˆì§€â€™ì— ì§‘ì¤‘, ë§ˆë¼í†¤(Marathon)ì€ â€˜ì´ ê¸€ììˆ˜â€™ë¥¼ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ì•„ì´ë””ì–´ ëª¨ë“œëŠ” ììœ ë¡­ê²Œ ë¸Œë ˆì¸ìŠ¤í† ë°í•˜ì„¸ìš”.',
      howto_2_title:'2) í™˜ê²½ ì„¸íŒ…',
      howto_2_body:'ë°©í•´ ìš”ì†Œ(íœ´ëŒ€í° ì•Œë¦¼, ë©”ì‹ ì €)ë¥¼ ë„ê³ , íƒ€ì´ë¨¸ ì‹œê°„ì„ ì •í•©ë‹ˆë‹¤. ì´ˆë°˜ì—” 5~10ë¶„, ì´í›„ 20~30ë¶„ìœ¼ë¡œ ëŠ˜ë ¤ë³´ì„¸ìš”.',
      howto_3_title:'3) ê·œì¹™ ì ìš©',
      howto_3_body:'SprintëŠ” 5ì´ˆ ì´ìƒ ë©ˆì¶”ë©´ ì‹¤íŒ¨, Marathonì€ ì‹œê°„ ë‚´ ëª©í‘œ ê¸€ììˆ˜ ë¯¸ë‹¬ ì‹œ ì‹¤íŒ¨, IdeaëŠ” 1ë¶„ ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨ì…ë‹ˆë‹¤.',
      howto_4_title:'4) ê¸°ë¡ & íšŒê³ ',
      howto_4_body:'ì„±ê³µ/ì‹¤íŒ¨ ì´ìœ ë¥¼ ê°„ë‹¨íˆ ì ì–´ ë‘ë©´ ë‹¤ìŒ ì„¸ì…˜ì˜ í’ˆì§ˆì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤. ìì‹ ì˜ ìµœì  ì‹œê°„ëŒ€ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.',
      howto_adsense_title:'AdSense ìŠ¹ì¸ íŒ(ê°„ë‹¨ ì²´í¬ë¦¬ìŠ¤íŠ¸)',
      adsense_content_title:'ì½˜í…ì¸  ì¶©ë¶„ì„±',
      adsense_content_body:'ì´ â€˜í™œìš©ë²•â€™ê³¼ â€˜ê°€ì´ë“œâ€™ì²˜ëŸ¼ ì‹¤ì§ˆì  ì„¤ëª… ë¬¸ì„œë¥¼ ìµœì†Œ 2~3ê°œ ì´ìƒ ì¤€ë¹„í•˜ì„¸ìš”. ì¤‘ë³µ/ë¹ˆì•½ ì½˜í…ì¸ ëŠ” í”¼í•˜ì„¸ìš”.',
      adsense_policy_title:'ì •ì±…/ë²•ì  ê³ ì§€',
      adsense_policy_body:'í•˜ë‹¨ì— ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨, ì´ìš©ì•½ê´€, ë¬¸ì˜ ë§í¬ë¥¼ ë§ˆë ¨í•©ë‹ˆë‹¤. ìˆ˜ì§‘í•˜ëŠ” ì •ë³´ê°€ ìˆë‹¤ë©´ ëª…í™•íˆ ê³ ì§€í•˜ì„¸ìš”.',
      adsense_speed_title:'ì ‘ì†ì„±/ì†ë„',
      adsense_speed_body:'ëª¨ë°”ì¼ì—ì„œ ì˜ ë³´ì´ê³ , ëŠë¦° ìš”ì†Œë¥¼ ì¤„ì´ë©´ ì‹¬ì‚¬/ìš´ì˜ì´ ì•ˆì •ì ì…ë‹ˆë‹¤.',

      guides_h2:'ê¸€ì“°ê¸° ê°€ì´ë“œ & ì¶”ì²œ ì‘ë²•ì„œ',
      guides_intro:'ì•„ë˜ ëª©ë¡ì€ ìŠ¤í† ë¦¬ êµ¬ì¡°ë¥¼ ë¹ ë¥´ê²Œ ì¡ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ëŒ€í‘œ ì°¸ê³ ì„œë“¤ì…ë‹ˆë‹¤.',
      guides_apply_title:'ë„êµ¬ì™€ í•¨ê»˜ ì“°ëŠ” ë°©ë²•',
      apply_sprint:'Sprint(ë‹¨ê±°ë¦¬)', apply_sprint_body:'í•œ ë¹„íŠ¸/ì¥ë©´ë§Œ ì„ íƒí•´ 5~10ë¶„ ë™ì•ˆ ëŠê¹€ ì—†ì´ ì²« ë¬¸ì¥~ë§ˆì§€ë§‰ ë¬¸ì¥ê¹Œì§€ ë°€ì–´ë¶™ì…ë‹ˆë‹¤. ìˆ˜ì •ì€ ê¸ˆì§€, íë¦„ë§Œ í™•ë³´!',
      apply_marathon:'Marathon(ë§ˆë¼í†¤)', apply_marathon_body:'ë¯¸ë“œí¬ì¸íŠ¸Â·í´ë¼ì´ë§¥ìŠ¤ ë“± í° ë¹„íŠ¸ ì´ˆì•ˆì— ì¢‹ìŠµë‹ˆë‹¤. ëª©í‘œ ê¸€ììˆ˜ì™€ ë‚¨ì€ ì‹œê°„ì„ ë³´ë©° í˜ì´ìŠ¤ë¥¼ ì¡°ì ˆí•˜ì„¸ìš”.',
      apply_idea:'Idea(ì•„ì´ë””ì–´)', apply_idea_body:'ë¡œê·¸ë¼ì¸/ìºë¦­í„° ê²°í•/í…Œë§ˆ ë¬¸ì¥ì„ ë©”ëª¨ë¡œ ë½‘ì•„ë‚´ëŠ” ì‹œê°„. 1ë¶„ ì´ìƒ ë©ˆì¶”ì§€ ì•Šë„ë¡ í‚¤ì›Œë“œë§Œì´ë¼ë„ ê³„ì† ì ìŠµë‹ˆë‹¤.',

      footer_privacy:'ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨', footer_terms:'ì´ìš©ì•½ê´€', footer_contact:'ë¬¸ì˜',
      footer_note:'ë³¸ ì‚¬ì´íŠ¸ëŠ” êµìœ¡/ì°½ì‘ í›ˆë ¨ì„ ìœ„í•œ ì •ì  ì›¹ ì•±ì…ë‹ˆë‹¤. í°íŠ¸ëŠ” Google Fonts(OFL) ì‚¬ìš©.'
    },
    en: {
      title:'Writing Training Challenge',
      subtitle:'Sprint / Marathon / Idea Â· Hard/Soft Modes Â· Share Results',
      tab_tool:'Tool', tab_howto:'How to Use', tab_guides:'Writing Guides',
      mode_title:'Choose Mode',
      mode_sprint_btn:'Sprint',
      mode_sprint_desc:'Â· 3/5/10/20/30 min Â· fail if idle for <b>5s</b>',
      mode_marathon_btn:'Marathon',
      mode_marathon_desc:'Â· Target chars + 40/60/90/120 min Â· fail if under target',
      mode_idea_btn:'Idea Mode',
      mode_idea_desc:'Â· 10/20/30 min Â· fail if no input for <b>1m</b>',
      difficulty_title:'Select Difficulty',
      difficulty_hard:'Hard', difficulty_hard_desc:'On fail, draft is deleted',
      difficulty_soft:'Soft', difficulty_soft_desc:'On fail, draft is kept (message only)',
      sprint_title:'Sprint Settings',
      label_session_time:'Session Time',
      min_3:'3 min', min_5:'5 min', min_10:'10 min', min_20:'20 min', min_30:'30 min',
      min_40:'40 min', hr_1:'1 hour', hr_1_5:'1h 30m', hr_2:'2 hours',
      btn_start:'Start', btn_back:'Back',
      sprint_rule:'If typing stops for <b>5 seconds</b>, instant fail.',
      marathon_title:'Marathon Settings',
      label_target_chars:'Target Characters',
      marathon_rule:'Fail if target count not met within time.',
      idea_title:'Idea Mode Settings',
      idea_rule:'Rule: if no input for <b>1 minute</b>, instant fail. (No char target)',
      session_running:'Session Running',
      label_time_left:'Time Left',
      label_char_count:'Current Characters',
      label_goal_chars:'Target Characters',
      placeholder_editor:'Write your draft/ideas here...',
      status_waiting:'Waiting for inputâ€¦',
      btn_giveup:'Give Up (End Now)',
      btn_restart:'Restart',

      howto_h2:'How to Use This Tool',
      howto_intro:'This mini trainer helps you write faster and more consistently. Set rules that fit your workflow.',
      howto_1_title:'1) Define Goals',
      howto_1_body:'Sprint focuses on â€œno stoppingâ€; Marathon targets total characters; Idea mode is free brainstorming.',
      howto_2_title:'2) Prep Your Environment',
      howto_2_body:'Silence distractions and pick a timer. Start with 5â€“10 minutes and scale to 20â€“30.',
      howto_3_title:'3) Apply Rules',
      howto_3_body:'Sprint fails after 5s idle; Marathon fails if under target; Idea fails after 1m idle.',
      howto_4_title:'4) Log & Retrospect',
      howto_4_body:'Note why you passed/failed. Youâ€™ll discover your best time-of-day and cadence.',
      howto_adsense_title:'AdSense Approval Tips (Quick Checklist)',
      adsense_content_title:'Content Sufficiency',
      adsense_content_body:'Publish at least 2â€“3 practical articles (like this guide) beyond the tool itself.',
      adsense_policy_title:'Policies/Legal',
      adsense_policy_body:'Provide Privacy Policy, Terms, and Contact links in the footer. Disclose any data collection.',
      adsense_speed_title:'Accessibility/Speed',
      adsense_speed_body:'Ensure mobile responsiveness and avoid slow bloat for smoother review & runtime.',

     
      footer_privacy:'Privacy Policy', footer_terms:'Terms of Use', footer_contact:'Contact',
      footer_note:'This is a static web app for education/creative practice. Fonts via Google Fonts (OFL).'
    }
  };
  let currentLang = 'ko';

  const langToggle = document.getElementById('langToggle');
  function applyI18n(){
    document.documentElement.lang = currentLang === 'ko' ? 'ko' : 'en';
    const map = dict[currentLang];
    document.querySelectorAll('[data-i18n]').forEach(node=>{
      const key = node.getAttribute('data-i18n');
      if(map[key]!==undefined) node.innerHTML = map[key];
    });
    document.querySelectorAll('[data-i18n-placeholder]').forEach(node=>{
      const key = node.getAttribute('data-i18n-placeholder');
      if(map[key]!==undefined) node.setAttribute('placeholder', map[key]);
    });
  }
  langToggle.addEventListener('click', ()=>{
    currentLang = (currentLang==='ko') ? 'en' : 'ko';
    applyI18n();
  });
  applyI18n();

  // ---------- Original App Logic ----------
  document.addEventListener('DOMContentLoaded', () => {
    const modeCard = document.getElementById('modeCard');
    const difficultyCard = document.getElementById('difficultyCard');
    const sprintSetup = document.getElementById('sprintSetup');
    const marathonSetup = document.getElementById('marathonSetup');
    const ideaSetup = document.getElementById('ideaSetup');
    const writingCard = document.getElementById('writingCard');
    const resultCard = document.getElementById('resultCard');

    const btnSprint = document.getElementById('btnSprint');
    const btnMarathon = document.getElementById('btnMarathon');
    const btnIdea = document.getElementById('btnIdea');

    const btnHard = document.getElementById('btnHard');
    const btnSoft = document.getElementById('btnSoft');

    const backFromSprint = document.getElementById('backFromSprint');
    const backFromMarathon = document.getElementById('backFromMarathon');
    const backFromIdea = document.getElementById('backFromIdea');

    const startSprintBtn = document.getElementById('startSprint');
    const startMarathonBtn = document.getElementById('startMarathon');
    const startIdeaBtn = document.getElementById('startIdea');

    const sprintDurationSel = document.getElementById('sprintDuration');
    const marathonDurationSel = document.getElementById('marathonDuration');
    const targetCharsInput = document.getElementById('targetChars');
    const ideaDurationSel = document.getElementById('ideaDuration');

    const sessionTitle = document.getElementById('sessionTitle');
    const timeLeftEl = document.getElementById('timeLeft');
    const charCountEl = document.getElementById('charCount');
    const goalBox = document.getElementById('goalBox');
    const goalCharsEl = document.getElementById('goalChars');

    const progressWrap = document.getElementById('progressWrap');
    const progressBar = document.getElementById('progressBar');
    const progressLabel = document.getElementById('progressLabel');
    const paceHint = document.getElementById('paceHint');

    const editor = document.getElementById('editor');
    const statusLine = document.getElementById('statusLine');
    const giveUpBtn = document.getElementById('giveUp');

    const resultHeadline = document.getElementById('resultHeadline');
    const resultDetail = document.getElementById('resultDetail');
    const restartBtn = document.getElementById('restart');

    const shareTwitter = document.getElementById('shareTwitter');
    const shareKakao = document.getElementById('shareKakao');
    const shareCopy = document.getElementById('shareCopy');

    let mode = null;          // 'sprint' | 'marathon' | 'idea'
    let difficulty = null;    // 'hard' | 'soft'
    let totalSeconds = 0;
    let remain = 0;
    let timerId = null;
    let idleTimeoutId = null;
    const IDEA_IDLE_LIMIT = 60;
    const SPRINT_IDLE_LIMIT = 5;

    const fmt = s => { const m=Math.floor(s/60), sec=s%60; return `${m}:${sec<10?'0'+sec:sec}`; };
    const show = el => el.classList.remove('hidden');
    const hide = el => el.classList.add('hidden');

    function resetToHome(){
      clearInterval(timerId); timerId = null;
      clearTimeout(idleTimeoutId); idleTimeoutId = null;

      editor.disabled = false;
      editor.value = ''; editor.oninput = null; editor.onkeydown = null;
      editor.removeAttribute('data-target');

      timeLeftEl.textContent = '--:--';
      charCountEl.textContent = '0';
      goalCharsEl.textContent = '0';
      statusLine.textContent = (currentLang==='ko' ? 'ì…ë ¥ ëŒ€ê¸° ì¤‘â€¦' : 'Waiting for inputâ€¦'); statusLine.className = 'center muted';
      progressBar.style.width = '0%'; progressLabel.textContent = 'ì§„í–‰: 0 / 0 (0%)'; paceHint.textContent = '';

      hide(writingCard); hide(resultCard); hide(sprintSetup); hide(marathonSetup); hide(ideaSetup); hide(difficultyCard);
      show(modeCard);

      mode = null; difficulty = null; totalSeconds = 0; remain = 0;
    }

    // Navigation inside tool
    btnSprint.onclick = () => { mode = 'sprint'; hide(modeCard); show(difficultyCard); };
    btnMarathon.onclick = () => { mode = 'marathon'; hide(modeCard); show(difficultyCard); };
    btnIdea.onclick = () => { mode = 'idea'; hide(modeCard); show(difficultyCard); };

    btnHard.onclick = () => { difficulty = 'hard'; goSetup(); };
    btnSoft.onclick = () => { difficulty = 'soft'; goSetup(); };

    function goSetup(){
      hide(difficultyCard);
      if(mode==='sprint') show(sprintSetup);
      else if(mode==='marathon') show(marathonSetup);
      else if(mode==='idea') show(ideaSetup);
    }

    backFromSprint.onclick = () => { hide(sprintSetup); show(modeCard); mode=null; difficulty=null; };
    backFromMarathon.onclick = () => { hide(marathonSetup); show(modeCard); mode=null; difficulty=null; };
    backFromIdea.onclick = () => { hide(ideaSetup); show(modeCard); mode=null; difficulty=null; };

    startSprintBtn.onclick = () => {
      totalSeconds = parseInt(sprintDurationSel.value,10);
      startSession();
    };
    startMarathonBtn.onclick = () => {
      const target = parseInt(targetCharsInput.value,10);
      if (isNaN(target) || target < 500){
        alert(currentLang==='ko' ? 'ëª©í‘œ ê¸€ììˆ˜ë¥¼ 500ì ì´ìƒìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”.' : 'Enter a target of at least 500 characters.');
        return;
      }
      totalSeconds = parseInt(marathonDurationSel.value,10);
      startSession(target);
    };
    startIdeaBtn.onclick = () => {
      totalSeconds = parseInt(ideaDurationSel.value,10);
      startSession();
    };

    function startSession(targetChars=null){
      hide(modeCard); hide(difficultyCard); hide(sprintSetup); hide(marathonSetup); hide(ideaSetup);
      show(writingCard);

      if(mode==='sprint'){
        sessionTitle.textContent = (currentLang==='ko')
          ? `ë‹¨ê±°ë¦¬ ì§„í–‰ì¤‘ (${fmt(totalSeconds)}) â€” 5ì´ˆ ë©ˆì¶”ë©´ ì‹¤íŒ¨`
          : `Sprint Running (${fmt(totalSeconds)}) â€” fail if 5s idle`;
        hide(goalBox); hide(progressWrap);
      }else if(mode==='marathon'){
        sessionTitle.textContent = (currentLang==='ko')
          ? `ë§ˆë¼í†¤ ì§„í–‰ì¤‘ (${fmt(totalSeconds)}) â€” ëª©í‘œ ê¸€ììˆ˜ ë‹¬ì„± í•„ìˆ˜`
          : `Marathon Running (${fmt(totalSeconds)}) â€” must hit target`;
        goalCharsEl.textContent = String(targetChars);
        show(goalBox); show(progressWrap);
        editor.dataset.target = String(targetChars);
      }else{
        sessionTitle.textContent = (currentLang==='ko')
          ? `ì•„ì´ë””ì–´ ëª¨ë“œ ì§„í–‰ì¤‘ (${fmt(totalSeconds)}) â€” 1ë¶„ ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨`
          : `Idea Mode (${fmt(totalSeconds)}) â€” fail if no input for 1m`;
        hide(goalBox); hide(progressWrap);
      }

      editor.disabled = false;
      editor.value = '';
      charCountEl.textContent = '0';
      statusLine.textContent = (currentLang==='ko' ? 'ì…ë ¥ ëŒ€ê¸° ì¤‘â€¦' : 'Waiting for inputâ€¦');
      statusLine.className = 'center muted';

      editor.oninput = () => {
        charCountEl.textContent = String(editor.value.length);
        if(mode==='sprint') resetIdle(SPRINT_IDLE_LIMIT);
        if(mode==='idea')   resetIdle(IDEA_IDLE_LIMIT);
        if(mode==='marathon') updateProgress();
      };
      editor.onkeydown = () => {
        if(mode==='sprint') resetIdle(SPRINT_IDLE_LIMIT);
        if(mode==='idea')   resetIdle(IDEA_IDLE_LIMIT);
      };

      remain = totalSeconds;
      timeLeftEl.textContent = fmt(remain);
      clearInterval(timerId); timerId = setInterval(tick,1000);

      if(mode==='sprint')  resetIdle(SPRINT_IDLE_LIMIT);
      if(mode==='idea')    resetIdle(IDEA_IDLE_LIMIT);
      if(mode==='marathon') updateProgress();

      editor.focus();
    }

    function tick(){
      remain--;
      timeLeftEl.textContent = fmt(remain);
      if(mode==='marathon') updateProgress();

      if(remain<=0){
        clearInterval(timerId);
        if(mode==='sprint'){
          success( (currentLang==='ko')
            ? `ë‹¨ê±°ë¦¬ ì„±ê³µ! ${fmt(totalSeconds)} ë™ì•ˆ ë©ˆì¶”ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`
            : `Sprint success! Kept typing for ${fmt(totalSeconds)}.` );
        }else if(mode==='marathon'){
          const target = parseInt(editor.dataset.target || '0',10);
          const len = editor.value.length;
          if(len >= target){
            success( (currentLang==='ko')
              ? `ë§ˆë¼í†¤ ì„±ê³µ! ${fmt(totalSeconds)} ë‚´ì— ${len.toLocaleString()}ì ì‘ì„± (ëª©í‘œ ${target.toLocaleString()}ì).`
              : `Marathon success! Wrote ${len.toLocaleString()} within ${fmt(totalSeconds)} (target ${target.toLocaleString()}).` );
          }else{
            fail( (currentLang==='ko')
              ? `ë§ˆë¼í†¤ ì‹¤íŒ¨! ${fmt(totalSeconds)} ë‚´ì— ${len.toLocaleString()}ì / ëª©í‘œ ${target.toLocaleString()}ì ë¯¸ë‹¬.`
              : `Marathon failed! ${len.toLocaleString()} / ${target.toLocaleString()} within ${fmt(totalSeconds)}.`, true);
          }
        }else{
          success( (currentLang==='ko')
            ? `ì•„ì´ë””ì–´ ëª¨ë“œ ì„±ê³µ! ${fmt(totalSeconds)} ë™ì•ˆ ë©ˆì¶”ì§€ ì•Šê³  ë¸Œë ˆì¸ìŠ¤í† ë° ì™„ë£Œ.`
            : `Idea Mode success! Continuous brainstorming for ${fmt(totalSeconds)}.` );
        }
      }
    }

    function updateProgress(){
      const target = parseInt(editor.dataset.target || '0',10);
      if(!target){ hide(progressWrap); return; }
      const len = editor.value.length;
      const pct = Math.max(0, Math.min(100, Math.round((len/target)*100)));
      progressBar.style.width = pct + '%';
      const label = (currentLang==='ko')
        ? `ì§„í–‰: ${len.toLocaleString()} / ${target.toLocaleString()} (${pct}%)`
        : `Progress: ${len.toLocaleString()} / ${target.toLocaleString()} (${pct}%)`;
      progressLabel.textContent = label;
      if(remain > 0){
        const need = Math.max(0, target - len);
        const needPerMin = Math.ceil(need / (remain/60));
        paceHint.textContent = (currentLang==='ko')
          ? `í•„ìš” ì†ë„: ë¶„ë‹¹ ${needPerMin.toLocaleString()}ì`
          : `Needed pace: ${needPerMin.toLocaleString()} chars/min`;
      }else{
        paceHint.textContent = '';
      }
    }

    function resetIdle(seconds){
      clearTimeout(idleTimeoutId);
      const ruleText = (mode==='sprint')
        ? (currentLang==='ko' ? '5ì´ˆ ì´ìƒ ë©ˆì¶”ë©´ ì‹¤íŒ¨' : 'Fail if 5s idle')
        : (mode==='idea' ? (currentLang==='ko' ? '1ë¶„ ë¬´ì…ë ¥ ì‹œ ì‹¤íŒ¨' : 'Fail if no input for 1m') : '');
      statusLine.textContent = (currentLang==='ko' ? 'ì…ë ¥ ì¤‘â€¦' : 'Typingâ€¦') + (ruleText?` (${ruleText})`:'');
      statusLine.className = 'center muted';
      idleTimeoutId = setTimeout(()=>{
        if(mode==='sprint'){
          fail( (currentLang==='ko')
            ? 'ë‹¨ê±°ë¦¬ ì‹¤íŒ¨! 5ì´ˆ ì´ìƒ íƒ€ì´í•‘ì´ ë©ˆì·„ìŠµë‹ˆë‹¤.'
            : 'Sprint failed! Typing stopped for over 5s.', true);
        }else if(mode==='idea'){
          fail( (currentLang==='ko')
            ? 'ì•„ì´ë””ì–´ ëª¨ë“œ ì‹¤íŒ¨! 1ë¶„ ì´ìƒ ì…ë ¥ì´ ì—†ì—ˆìŠµë‹ˆë‹¤.'
            : 'Idea mode failed! No input for over 1 minute.', true);
        }
      }, seconds*1000);
    }

    function success(msg){
      stopTimersKeepEditor();
      resultHeadline.textContent = (currentLang==='ko' ? 'ğŸ‰ ì„±ê³µ' : 'ğŸ‰ Success');
      resultHeadline.className = 'success center';
      resultDetail.textContent = msg + (currentLang==='ko'
        ? ' (ì›ê³ ëŠ” ì•„ë˜ ì—ë””í„°ì— ê·¸ëŒ€ë¡œ ë³´ì¡´ë©ë‹ˆë‹¤)'
        : ' (Your draft remains in the editor below)');
      show(resultCard);
    }

    function fail(msg, wipe=false){
      stopTimersKeepEditor();
      if(difficulty==='hard' && wipe){
        editor.value = '';
        charCountEl.textContent = '0';
        resultDetail.textContent = msg + (currentLang==='ko'
          ? ' (Hard ëª¨ë“œ â€” ì›ê³ ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤)'
          : ' (Hard mode â€” draft deleted)');
      }else{
        resultDetail.textContent = msg + (currentLang==='ko'
          ? ' (Soft ëª¨ë“œ â€” ì›ê³ ê°€ ë³´ì¡´ë©ë‹ˆë‹¤)'
          : ' (Soft mode â€” draft kept)');
      }
      resultHeadline.textContent = (currentLang==='ko' ? 'âš ï¸ ì‹¤íŒ¨' : 'âš ï¸ Failed');
      resultHeadline.className = 'fail center';
      show(resultCard);
    }

    function stopTimersKeepEditor(){
      clearInterval(timerId);
      clearTimeout(idleTimeoutId);
      timerId = null; idleTimeoutId = null;
      editor.disabled = false;
      show(writingCard);
    }

    giveUpBtn.onclick = ()=>{
      if(confirm(currentLang==='ko' ? 'ì •ë§ í¬ê¸°í•˜ì‹œê² ì–´ìš”?' : 'Really give up?')){
        fail( (currentLang==='ko') ? 'ì‚¬ìš©ì ì¤‘ë‹¨' : 'Stopped by user', true);
      }
    };
    restartBtn.onclick = resetToHome;

    function getShareText(){
      const baseUrl = (location.origin + location.pathname);
      return `${resultDetail.innerText}\n${currentLang==='ko' ? 'ë°”ë¡œ í•´ë³´ê¸°' : 'Try it now'}: ${baseUrl}`;
    }
    shareKakao.onclick = async ()=>{
      const text = getShareText();
      const shareData = { title:(currentLang==='ko'?'ê¸€ì“°ê¸° í›ˆë ¨ ì±Œë¦°ì§€':'Writing Training Challenge'), text, url: location.href };
      if(navigator.share){
        try{ await navigator.share(shareData); return; }catch(e){}
      }
      try{ await navigator.clipboard.writeText(text);
        alert(currentLang==='ko' ? 'ê³µìœ  í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ëì–´ìš”! ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.' : 'Copied! Paste into your messenger.');
      } catch(e){
        alert(currentLang==='ko' ? 'ë³µì‚¬ ì‹¤íŒ¨. ìˆ˜ë™ ë³µì‚¬ ë¶€íƒë“œë ¤ìš”.' : 'Copy failed. Please copy manually.');
      }
    };
    shareTwitter.onclick = ()=>{
      const t=encodeURIComponent(getShareText());
      window.open(`https://twitter.com/intent/tweet?text=${t}`,'_blank');
    };
    shareCopy.onclick = async ()=>{
      try{ await navigator.clipboard.writeText(getShareText());
        alert(currentLang==='ko' ? 'ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'Result copied!');
      }catch(e){
        alert(currentLang==='ko' ? 'ë³µì‚¬ ì‹¤íŒ¨. ìˆ˜ë™ ë³µì‚¬ ë¶€íƒë“œë ¤ìš”!' : 'Copy failed. Please copy manually!');
      }
    };
  });

  // Footer placeholder popups (simple)
  function openInfo(title, body){
    alert(`${title}\n\n${body}`);
  }
  document.getElementById('open-privacy').addEventListener('click', e=>{
    e.preventDefault();
    openInfo(
      (currentLang==='ko'?'ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨':'Privacy Policy'),
      (currentLang==='ko'
        ? 'ì´ ì‚¬ì´íŠ¸ëŠ” ê³„ì •ì„ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ë‚´ ì‘ì„± í…ìŠ¤íŠ¸ëŠ” ì„œë²„ì— ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'
        : 'This site does not collect accounts. Text you write stays in your browser and is not stored on a server.')
    );
  });
  document.getElementById('open-terms').addEventListener('click', e=>{
    e.preventDefault();
    openInfo(
      (currentLang==='ko'?'ì´ìš©ì•½ê´€':'Terms of Use'),
      (currentLang==='ko'
        ? 'ë³¸ ì‚¬ì´íŠ¸ëŠ” â€œìˆëŠ” ê·¸ëŒ€ë¡œâ€ ì œê³µë©ë‹ˆë‹¤. ì°½ì‘ë¬¼ì˜ ì €ì‘ê¶Œì€ ì‚¬ìš©ìê°€ ë³´ìœ í•©ë‹ˆë‹¤.'
        : 'This site is provided â€œas is.â€ You retain copyright to your writing.')
    );
  });
  document.getElementById('open-contact').addEventListener('click', e=>{
    e.preventDefault();
    openInfo(
      (currentLang==='ko'?'ë¬¸ì˜':'Contact'),
      (currentLang==='ko'
        ? 'ë¬¸ì˜: your@email.example'
        : 'Contact: your@email.example')
    );
  });
  </script>

  <!-- === (ì„ íƒ) ì—¬ê¸°ì— AdSense ìŠ¤ë‹ˆí«ì„ ì‚½ì…í•˜ì„¸ìš” ===
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX" crossorigin="anonymous"></script>
  -->
</body>
</html>
